# A script for basic software installations for NYPL's Digital Archives department.
echo "Installing xcode-stuff"
xcode-select --install

# Homebrew

## Check for Homebrew, install if needed

if test ! $(which brew); then
  echo "Installing homebrew..."
  /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
fi


## Add Homebrew taps

brew tap richardlehane/digipres


## Update homebrew recipes and apps

echo "Updating homebrew..."
brew update


## Install command-line apps

brew install git
brew install tree
brew install wget
brew install trash
brew install p7zip
brew install rsync
brew install richardlehane/digipres/siegfried
brew install m5deep
brew install bagit
brew install disktype
brew install gnu-tar
brew install python@3.8
brew install rbenv
brew install jenv

## Install GUI apps

brew install --cask vlc
brew install --cask virtualbox
brew install --cask mediainfo 

#other stuff- tbd
pip install bagit

# Configure Git
#To do: prompt for Git config
#echo "Git config"
#git config --global user.name "Your Name"
#git config --global user.email brad@bradparbs.com


# Update profile

## Test what shell is used
case $SHELL in
*/zsh) 
  profile="$HOME/.zshrc"
  ;;
*/bash)
  profile="$HOME/.bash_profile"
  ;;
*)
  exit
esac


## Configure code distribution managers

### Configure rbenv
if ! grep -q "rbenv" $profile; then
	cat <<- 'END' >> $profile
	# Configure rbenv
	export PATH="$HOME/.rbenv/bin:$PATH"
	eval "$(rbenv init -)"

	END
fi

### Configure jenv
if ! grep -q "jenv" $profile; then
	echo hi
	cat <<- 'END' >> $profile 
	# Configure jenv
	export PATH="$HOME/.jenv/bin:$PATH"
	eval "$(jenv init -)"

	END
fi

### Configure pyenv
if ! grep -q "pyenv" $profile; then
	cat <<- 'END' >> $profile 
	# Configure pyenv
	export PATH="$HOME/.pyenv/bin:$PATH"
	eval "$(pyenv init -)"
	
	END
fi


## Configure aliases

### Add alias for VS Code
if ! grep -q "Visual Studio Code" $profile; then
	cat <<- 'END' >> $profile 
	# Configure VS Code
	export PATH="$PATH:/Applications/Visual Studio Code.app/Contents/Resources/app/bin"
	
	END
fi


## Reload profile with modifications

source $profile


# VS Code extensions

## git extensions
code --install-extension github.vscode-pull-request-github

## markdown
code --install-extension DavidAnson.vscode-markdownlint
code --install-extension yzhang.markdown-all-in-one
code --install-extension streetsidesoftware.code-spell-checker

## data formats
code --install-extension DotJoshJohnson.xml
code --install-extension mechatroner.rainbow-csv

## coding
code --install-extension ms-python.python
code --install-extension ms-toolsai.jupyter

## terminal 
code --install-extension foxundermoon.shell-format
code --install-extension bmalehorn.shell-syntax
code --install-extension ms-vscode-remote.remote-ssh
code --install-extension ms-vscode-remote.remote-ssh-edit
